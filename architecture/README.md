# Архитектура проекта
Архитектура проекта, организация кода.

Использование глобальных переменных считается плохой практикой в современном программировании, особенно в контексте WordPress. Причина этого заключается в том, что глобальные переменные могут привести к непредсказуемому поведению кода, усложнению поддержки и проблемам с читабельностью. Вместо этого лучше использовать другие подходы, такие как классы, зависимости через контейнеры, фильтры и хуки WordPress.

Давайте рассмотрим альтернативные варианты, которые помогут избежать использования глобальных переменных.

## Классы и синглтон-паттерн
Один из самых популярных способов организации кода в WordPress – это создание классов и использование паттерна Singleton. Паттерн Singleton гарантирует, что существует только одна инстанция класса, и все обращения к этому классу будут происходить через одну точку доступа.

Пример:

```php
// functions.php
class MySingleton {
  private static $instance;

  private function __construct() {}

  public static function getInstance() {
    if (!isset(self::$instance)) {
      self::$instance = new self();
    }
    return self::$instance;
  }

  public function doSomething() {
    // Логика метода
  }
}

// Регистрация методов в качестве экшенов или фильтров
add_action('wp_loaded', [MySingleton::getInstance(), 'someMethod']);
```

```php
// Шаблон темы
$singleton = MySingleton::getInstance();
$singleton->doSomething();
```

Этот подход обеспечивает централизованное управление состоянием и предотвращает использование глобальных переменных.

## Фильтры и хуки
WordPress предоставляет мощные механизмы фильтрации и хуков, которые позволяют передавать данные между различными частями системы без использования глобальных переменных.

Пример:

```php
// functions.php
function create_object() {
  $obj = new MyClass();
  return $obj;
}
add_filter('my_custom_object', 'create_object');
```

```php
// Шаблон темы
$obj = apply_filters('my_custom_object', null);
if ($obj instanceof MyClass) {
  // Используем объект
  $obj->doSomething();
}
```

Такой подход позволяет передавать объекты и данные между разными частями кода, избегая глобальных переменных.

## Контейнеры зависимостей
Хотя контейнеры зависимостей редко используются в стандартных темах WordPress, они являются мощным инструментом для управления зависимостями и обеспечивают высокую гибкость и тестируемость кода.

Пример с использованием контейнера зависимостей Pimple:

```php
// functions.php
use Pimple\Container;

$container = new Container();

$container['my_class'] = function ($c) {
  return new MyClass();
};

add_action('wp_loaded', function () use ($container) {
  $container['my_class']->doSomething();
});
```

```php
// Шаблон темы
global $container;
$container['my_class']->doSomethingElse();
```

## Заключение
Избегайте использования глобальных переменных в пользу более современных подходов, таких как классы, паттерны проектирования (например, Singleton), фильтры и хуки WordPress, а также контейнеры зависимостей. Эти методы обеспечат лучшую организацию кода, упростят поддержку и тестирование, а также сделают ваш проект более масштабируемым и надежным.
