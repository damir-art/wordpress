# Когда global $post необходимо?
Когда нужно вставлять строку `global $post;` перед использование переменной $post.

## Функции и методы
Если вы работаете внутри функции или метода, то PHP создаёт локальную область видимости для переменных. Чтобы получить доступ к глобальной переменной `$post`, её нужно объявить с помощью ключевого слова `global`. Например:

```php
function my_custom_function() {
  global $post;
  echo $post->post_title;
}
```

## Шаблоны тем
Внутри файлов шаблона темы WordPress (например, `single.php`, `page.php`) переменная `$post` уже доступна автоматически, поэтому нет необходимости писать `global $post;`. Она будет доступна сразу после вызова функции `setup_postdata()` или `the_post()`.

## Когда global $post не требуется?

### Циклы WordPress
Внутри стандартных циклов WordPress, таких как `while (have_posts()) : the_post();`, переменная `$post` обновляется автоматически, и вы можете обращаться к ней непосредственно, без объявления `global`.

```php
while ( have_posts() ) : the_post();
  echo '<h1>' . get_the_title() . '</h1>';
  the_content();
endwhile;
```

### Некоторые хуки и фильтры
В некоторых случаях WordPress передаёт переменную `$post` прямо в функцию через аргументы. Тогда объявление `global` также не потребуется.

```php
add_filter( 'the_content', 'add_some_text_to_content' );

function add_some_text_to_content( $content ) {
    return $content . '<p>Это добавленный текст.</p>';
}
```

## Заключение
Итак, использование `global $post;` зависит от контекста вашего кода. Если вы находитесь вне стандартной области видимости цикла WordPress или внутри функции/метода, тогда вам нужно объявлять эту переменную как глобальную. В остальных случаях она обычно доступна автоматически.
