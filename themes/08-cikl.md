# Цикл (Loop) &ndash; темизация WordPress
Цикл WP организует вывод контента. Благодаря шаблонам WP понимает какой контент надо вывести.

Рассмотрим функции цикла. Цикл находится внутри файла index.php, между шапкой и подвалом.

index.php содержит основной цикл, который выводит на экран все существующие записи (посты) сайта.

Количество постов, выводимых файлом index.php, зависит от настроек админки WordPress: Админка > Настройки > Чтение (по-стандарту это 10 постов), после которых идёт постраничная навигация.

## Схема цикла WordPress

    <?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>
        <!-- Цикл WordPress -->
        <p>Выводим данные записи. Здесь работают функции для цикла, например, the_title() </p>
        <h2><?php the_title() ?></h2> 
    <?php endwhile; else : ?>
        <p>Записей нет.</p>
    <?php endif; ?>

- have_posts() - возвращает true или false в зависимости от того существуют записи или нет.
- while ( have_posts() ) - выводим записи пока они есть
- the_post() - объект текущей записи
- the_posts_pagination() - пагинация

Желательно весь пост в архивных шаблонах обернуть ссылкой.

## Функции-шаблона используемые внутри цикла

    the_permalink() - ссылка на текущий пост
    the_title() - вывод заголовка поста
    the_excerpt() - отрывок
    the_content('Читать далее...') - вывод контента поста
    the_post_thumbnail() - вывод миниатюры поста
    the_time('j M Y') - вывод даты и времени создания поста
    the_date() - вывод даты, работает 1 раз внутри шаблона, чтобы обойти нажно записачть через `get`
    the_category(', ') - вывод категории поста
    the_tags() - вывод меток (тегов) поста
    posts_nav_link() - вывод ссылок на следующую/предыдущую страницу с постами, после цикла

У каждой функции-шаблона есть функция начинающая с `get`, например get_the_permalink(), она не выводит а возвращает данные.

Остальные:

    the_author(); - вывод автора записи
    edit_post_link('Edit', ' &#124; ', ''); - редактировать пост, для авторизованных

## the_excerpt()
the_excerpt() - отрывок, используется в файл-шаблоноах типа archive. Берет первые 55 слов, если не заполнено в админке. Правильней использовать `echo get_the_excerpt()`.

## the_post_thumbnail()
- the_post_thumbnail() - вывод миниатюры поста
- возвращает ссылку на мииатюру поста

Пример:

    the_post_thumbnail( 'full', ['class' => 'my__class'] )

## Постраничная навигация
Чтобы создать постраничную навигацию, нужно после цикла `endwhile` и до `else:` разместить:

    <?php the_posts_pagination() ?>

## Подробнее о функциях цикла
Проверка на наличие постов:

    <?php if(have_posts()): ?>
        /* Проверяет найдены ли посты на текущей странице */
    <?php endif; ?>

Цикл выводящий все имеющиеся посты блога:

    <?php while(have_posts()): the_post(); ?>
        /* Вывод всех записей */
    <?php endwhile; ?>

## Работаем с цитатами в цикле
Работаем с цитатами (анонсами) в цикле WordPress

Цитата позволяет выводить отрывок поста, в цикле вывода записей. В конце цитаты появляется: `[...]`.

Чтобы иметь возможность выводить цитаты в цикле WordPress, нужно сделать следующее:

- Поставить галочку, возле слова **Цитата**, на странице создания записи
- Разместь в файле `index.php` функцию the_excerpt(), вместо the_content()

Чтобы манипулировать различными параметрами, например удалении знака [...], количеством слов (при автоматическом выводе цитат) или размещении слов "читать далее" (в конце цитаты), нужно записать различные функции в файл functions.php

При создании поста, автор должен самостоятельно, вписывать цитату в специальное поле. Если же цитата не вписана, то она создастся автоматически и будет вмещать в себя первые 55 слов поста, при этом изображения и html-теги обрезаются.

Eсли вы не хотите использовать цитаты и вам нужно просто обрезать текст без сохранения html-тегов и прочего, то можно воспользоваться следующей строкой внутри цикла WordPress:</p>

    <p>
        <?php echo mb_substr(strip_tags( get_the_content()), 0, 152 ); ?>...
    </p>
    
    где 152 - это количество вставляемых символов

## Разное
- https://wp-kama.ru/id_119/chto-takoe-tsikl-the-loop-v-wordpress.html - цикл WordPress
- https://wp-kama.ru/id_767/3-sposoba-postroeniya-tsiklov-v-wordpress.html - три способа создания цикла в WordPress
