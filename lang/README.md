# Перевод
https://wp-kama.ru/handbook/cheatsheet - локализация (перевод)  
https://wp-kama.ru/handbook/codex/translations - переводы локализация  
https://wp-kama.ru/function-tag/localize - функции перевода, localize (l10n i18n локализация Internationalization)

Перевод (локализация) тем и плагинов WordPress. Подготовка тем к переводу. Перевод тем необходим для премиальных (платных), для репозитория WordPress или мультиязычных тем.

- перевод всех строк шаблона, согласно выбранному языку
- переводим фразы шаблонов-темы и админки, а не самого контента (статьи поста, статьи должен переводить контент менеджер, переводчик, также есть плагин для перевода контента polylang)
- можно не переводить, но подготовить фразы к переводу необходимо, обрамить их специальными функциями
- изначально тему делают англоязычной
- затем добавляют русский перевод

Переведем кнопку `Читать далее` (в цикле):
- переключим сайт на английский язык `Настройки > Общие > Язык сайта > Английский`
- кнопка `Далее` не переведется
- переводы стандартных тем (они изначально созданы на английском) `twenty**` находятся в папке `wp-content\languages\themes` (тут хранятся файлы переводов на русский язык)

Перед переводом сделаем наш сайт англоязычным и переведем кнопку на `Read more`

    <?php _e( 'Read more', 'legioner' ); ?>

- английский язык делаем изначальным языком темы (все слова шаблонов пишем на английском), а для русского создаём файл перевода

Регистрируем идентификатор файла перевода, в файле `functions.php` прописываем `load_theme_textdomain()` - загружает файл перевода темы `.mo` (вешаем на функцию подключающуюся к хуку after_setup_theme):

    // Подключаем языковой файл перевода
    load_theme_textdomain( 'legioner', get_template_directory() . '/languages' );

- создаём в нашей теме `/legioner` папку `/languages`
- в файл style.css прописываем параметр `Text Domain: legioner`, может работать и без этого
- файлы переводов создают и переводят через программу https://poedit.net
- у нас изначально тема английская, нам нужно создать файл с переводом на русский
- создать новый перевод можно только в PRO версии, поэтому нам нужно найти бесплатный файл шаблон перевода, например `test.pot`
- помещаем файл `test.pot` в папку `/legioner/languages`
- запускаем программу poedit
- жмем по кнопке `Создать новый...` *Создать новый перевод из шаблона POT*
- выбираем `русский (Россия)` или прописываем `ru_RU`
- жмём по кнопке OK
- Сохраняем файл в `/legioner/languages`
- в папке должно появиться два файла `ru_RU.mo` и `ru_RU.po`
- переходим `Перевод > Свойства`
  - `Свойства перевода > Название и версия проекта`: legioner 1.0.0
  - `Папки с иходными файлами` добавляем папку темы `legioner`
  - `Ключевые слова исходных файлов`, добавляем функции перевода:
    - `__`, `_e`, `esc_html__`, `esc_html_e`
  - жмём кнопку `ОК`
- жмём кнопку `Сохранить`
- жмём кнопку `Обновить из кода`
- в поле `Перевод` прописываем `Читать далее`
- жмем по кнопке `Сохранить`
- переключаемся на английскую и русскую версию WordPress, проверяем перевод

Чаще всего используют четыре функции локализации:
- `__()` - получает перевод строки
- `_e()` - выводит перевод строки
- `esc_html__()` - получает перевод строки + esc_html(), для HTML-кода с контентом и безопасность
- `esc_html_e()` - выводит перевод строки + esc_html(), для HTML-кода с контентом и безопасность
- `esc_attr__()` - получает перевод строки + esc_attr() для атрибута и безопасность
- `esc_attr_e()` - выводит перевод строки + esc_attr() для атрибута и безопасность

## Основные функции
- __() Получает перевод строки.
- _e() Выводит перевод строки.
- _n() Получает перевод строки после числа.
- esc_attr__() Получает перевод строки + esc_attr().
- esc_attr_e() Выводит перевод строки + esc_attr().
- esc_html__() Получает перевод строки + esc_html().
- esc_html_e() Выводит перевод строки + esc_html().
- _x() Получает перевод строки для контекста
- _ex() Выводит перевод строки для контекста
- _nx() Получает перевод строки после числа для контекста.
- date_i18n() Получает переведенную дату. Локализация для date().
- determine_locale() Получает локаль сайта, подходящую для текущего запроса.
- get_locale() Получает локаль сайта. Пр: en_US.
- get_user_locale() Получает локаль юзера.
- switch_to_locale() Переключает локаль сайта.
- is_locale_switched() Проверяет была ли использована switch_to_locale().
- load_plugin_textdomain() Загружает .mo файл из папки плагина.
- load_muplugin_textdomain() Загружает .mo файл из папки MU плагина.
- load_theme_textdomain() Загружает .mo файл из папки темы.
- load_child_theme_textdomain() Загружает .mo файл из папки дочерней темы.
- load_textdomain() Загружает указанный .mo файл из любой папки.
- is_textdomain_loaded() Проверяет загружен ли .mo файл.
- unload_textdomain() Выгружает загруженный .mo файл.
